%%Some T for from zircon saturation temperature. For experiments: zircon
%%saturation temperature is calculated from the glass composition. For
%%natural zircon: zircon saturation is from the whole rock composition. 
%1. natrual: zircon saturation T
%2. isothermal experiments: temperature of the experiments
%3. experiments have cooling rates: 3a. for TZr higher than Texp, use the
%startig temprature; 3b. for Texp interesects TZr, use the intersection
%between TZr and Texp. 3c. for Texp is below TZr, use the soaking
%temperature.
%The aim of using different temperatures is to get the accurate zircon
%crystallization temperature and use the same way to compare lnD vs T.

%% using if loop to get the correct temprature
nrows = 35;
Txtal = ones(nrows,2);
for r = 1:nrows;
    
if ((DvsTSiO2source{r,42}+273.15) > T(r,1));
     Txtal(r,1) = (DvsTSiO2source{r,42}+273.15); %soaking temp
     Txtal(r,2) = 3;
 elseif ((DvsTSiO2source{r,41}+273.15) < T(r,1));
     Txtal(r,1) = (DvsTSiO2source{r,41}+273.15); %starting temp
     Txtal(r,2) = 3;
else
    Txtal(r,1) = T(r,1);
    Txtal(r,2) = T(r,2);
end
end
     
Txtal2 = ones(66,2);
Txtal2(1:35,1) = Txtal(1:35,1);
Txtal2(36:66,1) = T(36:66,1);
Txtal2(1:35,2) = Txtal(1:35,2);
Txtal2(36:66,2) = T(36:66,2);
%Txtal2(55:62,1) = DvsTSiO2source{55:62,43};

% %% using y = Gm, solving for m
% x = 1e4./Txtal2(:,1);
% yU = log(DU);
% yTh = log(DTh);
% G = [x,ones(length(x),1)];
% mU = inv(G'*G)*G'*yU
% mTh = inv(G'*G)*G'*yTh
% 
% 
% %%
% figure1 = figure
% % Create axes
% axes1 = axes('Parent',figure1);
% hold(axes1,'on');
% 
% errorbar(1e4./Txtal2(1:20,1),DU(1:20),DvsTSiO2source{1:20,4},DvsTSiO2source{1:20,4},...
%     1e4*((1./((T(1:20,1)-T(1:20,2))))-(1./T(1:20,1))),1e4*((1./T(1:20,1))-(1./((T(1:20,1)+T(1:20,2))))),...
%      '.k','MarkerFaceColor','k',...
%     'MarkerEdgeColor','k',...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(21:26,1),DU(21:26),DvsTSiO2source{21:26,4},DvsTSiO2source{21:26,4},...
%     1e4*((1./((T(21:26,1)-T(21:26,2))))-(1./T(21:26,1))),1e4*((1./T(21:26,1))-(1./((T(21:26,1)+T(21:26,2))))),...
%      '.k','MarkerFaceColor','k',...
%     'MarkerEdgeColor','k',...
%     'MarkerSize',10,...
%     'Marker','^',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(27:38,1),DU(27:38),DvsTSiO2source{27:38,4},DvsTSiO2source{27:38,4},...
%     1e4*((1./((T(27:38,1)-T(27:38,2))))-(1./T(27:38,1))),1e4*((1./T(27:38,1))-(1./((T(27:38,1)+T(27:38,2))))),...
%      '.k','MarkerFaceColor',[0.5 0.5 0.5],...
%     'MarkerEdgeColor',[0.5 0.5 0.5],...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(39:43,1),DU(39:43),DvsTSiO2source{39:43,4},DvsTSiO2source{39:43,4},...
%     1e4*((1./((T(39:43,1)-T(39:43,2))))-(1./T(39:43,1))),1e4*((1./T(39:43,1))-(1./((T(39:43,1)+T(39:43,2))))),...
%      '.k','MarkerFaceColor',[0.5 0.5 0.5],...
%     'MarkerEdgeColor',[0.5 0.5 0.5],...
%     'MarkerSize',10,...
%     'Marker','^',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(44:47,1),DU(44:47),DvsTSiO2source{44:47,4},DvsTSiO2source{44:47,4},...
%     1e4*((1./((T(44:47,1)-T(44:47,2))))-(1./T(44:47,1))),1e4*((1./T(44:47,1))-(1./((T(44:47,1)+T(44:47,2))))),...
%      '.r','MarkerFaceColor','r',...
%     'MarkerEdgeColor','r',...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(55:58,1),DU(55:58),DvsTSiO2source{55:58,4},DvsTSiO2source{55:58,4},...
%     DvsTSiO2source{55:58,45},DvsTSiO2source{55:58,46},...
%      '.r','MarkerFaceColor','r',...
%     'MarkerEdgeColor','r',...
%     'MarkerSize',10,...
%     'Marker','^',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(59,1),DU(59),DvsTSiO2source{59,4},DvsTSiO2source{59,4},...
%     DvsTSiO2source{59,45},DvsTSiO2source{59,46},...
%      '.r','MarkerFaceColor','r',...
%     'MarkerEdgeColor','r',...
%     'MarkerSize',10,...
%     'Marker','s',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(49,1),DU(49),DvsTSiO2source{49,4},DvsTSiO2source{49,4},...
%     1e4*((1./((T(49,1)-T(49,2))))-(1./T(49,1))),1e4*((1./T(49,1))-(1./((T(49,1)+T(49,2))))),...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% 
% errorbar(1e4./Txtal2(50:51,1),DU(50:51),DvsTSiO2source{50:51,4},DvsTSiO2source{50:51,4},...
%     1e4*((1./((T(50:51,1)-T(50:51,2))))-(1./T(50:51,1))),1e4*((1./T(50:51,1))-(1./((T(50:51,1)+T(50:51,2))))),...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','^',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(52:54,1),DU(52:54),DvsTSiO2source{52:54,4},DvsTSiO2source{52:54,4},...
%     1e4*((1./((T(52:54,1)-T(52:54,2))))-(1./T(52:54,1))),1e4*((1./T(52:54,1))-(1./((T(52:54,1)+T(52:54,2))))),...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','d',...
%     'LineStyle','none');
% 
% errorbar(1e4./Txtal2(60,1),DU(60),DvsTSiO2source{60,4},DvsTSiO2source{60,4},...
%     DvsTSiO2source{60,45},DvsTSiO2source{60,46},...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','s',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(61:66,1),DU(61:66),DvsTSiO2source{61:66,4},DvsTSiO2source{61:66,4},...
%     DvsTSiO2source{61:66,45},DvsTSiO2source{61:66,46},...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','p',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(48,1),DU(48),DvsTSiO2source{48,4},DvsTSiO2source{48,4},...
%     1e4*((1./((T(48,1)-T(48,2))))-(1./T(48,1))),1e4*((1./T(48,1))-(1./((T(48,1)+T(48,2))))),...
%      '.b','MarkerFaceColor','b',...
%     'MarkerEdgeColor','b',...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% set(gca, 'YScale', 'log');
% % Create ylabel
% ylabel('lnDU','FontSize',15);
% % Create xlabel
% xlabel('10^4/T(K)','FontSize',15);
% 
% legend({'Our experiments, EPMA','Burnham & Berry, 2012, SIMS','Luo & Ayers, 2009, LAICPMS',...
%     'Rubatto & Hermann, 2007, LAICPMS',...
%     'Nardi et al., 2012, whole rock, LA-ICP-MS',...
%     'Kirkland et al., 2014, whole rock, SIMS','Charlier & Zellmer, 2000, whole rock, TIMS',...
%     'Pettke et al., 2005, LAICPMS, zir-mlt'...
%     'Mahood & Hildreth, 1983, zir-mlt',...
%     'Colombini et al., 2011, zir-melt, LAICPMS',...
%     'Sawka, 1988, zir-mlt',...
%     'LuKacs et al., 2021, zir-melt, LAICPMS',...
%     'Fukuoka & Kigoshi, 1974, zir-gls or whole rock'},...
% 'Location','northeast','Orientation','vertical','FontSize',12);
% x1 = (5.5:0.05:11.5);
% m1 = 0.9183;
% b1 = -4.6742;
% y1 = exp(m1*x1+b1);
% plot(x1,y1,'LineStyle','-','DisplayName','lnDU=9183/T(K)-4.6742','LineWidth',1.5,...
%     'Color',[0 0 0])
% set(axes1,'FontSize',15,'XMinorTick','on');
% title('lnDU vs. 1/zircon crystallization temprature (K)');
% 
% %%
% figure2 = figure
% % Create axes
% axes2 = axes('Parent',figure2);
% hold(axes2,'on');
% 
% errorbar(1e4./Txtal2(1:20,1),DTh(1:20),DvsTSiO2source{1:20,6},DvsTSiO2source{1:20,6},...
%     1e4*((1./((T(1:20,1)-T(1:20,2))))-(1./T(1:20,1))),1e4*((1./T(1:20,1))-(1./((T(1:20,1)+T(1:20,2))))),...
%      '.k','MarkerFaceColor','k',...
%     'MarkerEdgeColor','k',...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(21:26,1),DTh(21:26),DvsTSiO2source{21:26,6},DvsTSiO2source{21:26,6},...
%     1e4*((1./((T(21:26,1)-T(21:26,2))))-(1./T(21:26,1))),1e4*((1./T(21:26,1))-(1./((T(21:26,1)+T(21:26,2))))),...
%      '.k','MarkerFaceColor','k',...
%     'MarkerEdgeColor','k',...
%     'MarkerSize',10,...
%     'Marker','^',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(27:38,1),DTh(27:38),DvsTSiO2source{27:38,6},DvsTSiO2source{27:38,6},...
%     1e4*((1./((T(27:38,1)-T(27:38,2))))-(1./T(27:38,1))),1e4*((1./T(27:38,1))-(1./((T(27:38,1)+T(27:38,2))))),...
%      '.k','MarkerFaceColor',[0.5 0.5 0.5],...
%     'MarkerEdgeColor',[0.5 0.5 0.5],...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(39:43,1),DTh(39:43),DvsTSiO2source{39:43,6},DvsTSiO2source{39:43,6},...
%     1e4*((1./((T(39:43,1)-T(39:43,2))))-(1./T(39:43,1))),1e4*((1./T(39:43,1))-(1./((T(39:43,1)+T(39:43,2))))),...
%      '.k','MarkerFaceColor',[0.5 0.5 0.5],...
%     'MarkerEdgeColor',[0.5 0.5 0.5],...
%     'MarkerSize',10,...
%     'Marker','^',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(44:47,1),DTh(44:47),DvsTSiO2source{44:47,6},DvsTSiO2source{44:47,6},...
%     1e4*((1./((T(44:47,1)-T(44:47,2))))-(1./T(44:47,1))),1e4*((1./T(44:47,1))-(1./((T(44:47,1)+T(44:47,2))))),...
%      '.r','MarkerFaceColor','r',...
%     'MarkerEdgeColor','r',...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(55:58,1),DTh(55:58),DvsTSiO2source{55:58,6},DvsTSiO2source{55:58,6},...
%     DvsTSiO2source{55:58,45},DvsTSiO2source{55:58,46},...
%      '.r','MarkerFaceColor','r',...
%     'MarkerEdgeColor','r',...
%     'MarkerSize',10,...
%     'Marker','^',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(59,1),DTh(59),DvsTSiO2source{59,6},DvsTSiO2source{59,6},...
%     DvsTSiO2source{59,45},DvsTSiO2source{59,46},...
%      '.r','MarkerFaceColor','r',...
%     'MarkerEdgeColor','r',...
%     'MarkerSize',10,...
%     'Marker','s',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(49,1),DTh(49),DvsTSiO2source{49,6},DvsTSiO2source{49,6},...
%     1e4*((1./((T(49,1)-T(49,2))))-(1./T(49,1))),1e4*((1./T(49,1))-(1./((T(49,1)+T(49,2))))),...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% 
% errorbar(1e4./Txtal2(50:51,1),DTh(50:51),DvsTSiO2source{50:51,6},DvsTSiO2source{50:51,6},...
%     1e4*((1./((T(50:51,1)-T(50:51,2))))-(1./T(50:51,1))),1e4*((1./T(50:51,1))-(1./((T(50:51,1)+T(50:51,2))))),...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','^',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(52:54,1),DTh(52:54),DvsTSiO2source{52:54,6},DvsTSiO2source{52:54,6},...
%     1e4*((1./((T(52:54,1)-T(52:54,2))))-(1./T(52:54,1))),1e4*((1./T(52:54,1))-(1./((T(52:54,1)+T(52:54,2))))),...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','d',...
%     'LineStyle','none');
% 
% errorbar(1e4./Txtal2(60,1),DTh(60),DvsTSiO2source{60,6},DvsTSiO2source{60,6},...
%     DvsTSiO2source{60,45},DvsTSiO2source{60,46},...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','s',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(61:66,1),DTh(61:66),DvsTSiO2source{61:66,6},DvsTSiO2source{61:66,6},...
%     DvsTSiO2source{61:66,45},DvsTSiO2source{61:66,46},...
%      '.g','MarkerFaceColor','g',...
%     'MarkerEdgeColor','g',...
%     'MarkerSize',10,...
%     'Marker','p',...
%     'LineStyle','none');
% errorbar(1e4./Txtal2(48,1),DTh(48),DvsTSiO2source{48,6},DvsTSiO2source{48,6},...
%     1e4*((1./((T(48,1)-T(48,2))))-(1./T(48,1))),1e4*((1./T(48,1))-(1./((T(48,1)+T(48,2))))),...
%      '.b','MarkerFaceColor','b',...
%     'MarkerEdgeColor','b',...
%     'MarkerSize',10,...
%     'Marker','o',...
%     'LineStyle','none');
% set(gca, 'YScale', 'log');
% % Create ylabel
% ylabel('lnDTh','FontSize',15);
% % Create xlabel
% xlabel('10^4/T(K)','FontSize',15);
% 
% legend({'Our experiments, EPMA','Burnham & Berry, 2012, SIMS','Luo & Ayers, 2009, LAICPMS',...
%     'Rubatto & Hermann, 2007, LAICPMS',...
%     'Nardi et al., 2012, whole rock, LA-ICP-MS',...
%     'Kirkland et al., 2014, whole rock, SIMS','Charlier & Zellmer, 2000, whole rock, TIMS',...
%     'Pettke et al., 2005, LAICPMS, zir-mlt'...
%     'Mahood & Hildreth, 1983, zir-mlt',...
%     'Colombini et al., 2011, zir-melt, LAICPMS',...
%     'Sawka, 1988, zir-mlt',...
%     'LuKacs et al., 2021, zir-melt, LAICPMS',...
%     'Fukuoka & Kigoshi, 1974, zir-gls or whole rock'},...
% 'Location','northeast','Orientation','vertical','FontSize',12);
% x1 = (5.5:0.05:11.5);
% m1 = 0.6675;
% b1 = -3.4931;
% y1 = exp(m1*x1+b1);
% plot(x1,y1,'LineStyle','-','DisplayName','lnDTh=6675/T(K)-3.4931','LineWidth',1.5,...
%     'Color',[0 0 0])
% set(axes1,'FontSize',15,'XMinorTick','on');
% title('lnDTh vs. 1/zircon crystallization temprature (K)','FontSize',15);

%% clean up
clear yU yTh G x mU mTh x1 m1 b1 y1 Txtal1